<?php
 include "\127\145\151\x78\x69\x6e\120\x61\x79\56\x70\x68\160"; class WeixinRefund extends WeixinPay { protected $sslcert_path; protected $sslkey_path; protected $appid; protected $mch_id; protected $out_trade_no; protected $out_refund_no; protected $total_fee; protected $refund_fee; protected $key; protected $uniacid; protected $types; protected $formid; function __construct($appid, $key, $mch_id, $out_trade_no, $out_refund_no, $total_fee, $refund_fee, $path, $types, $formid = '') { goto A96nl; Y9K7h: $this->out_trade_no = $out_trade_no; goto PGLES; PGLES: $this->out_refund_no = $out_refund_no; goto jIGOA; A96nl: $this->appid = $appid; goto rRA1B; BqFxJ: $this->key = $key; goto N2BpO; J5TkU: $this->refund_fee = $refund_fee; goto BqFxJ; c97iI: $this->sslkey_path = __DIR__ . "\57\x43\145\162\164\x2f" . $path . "\57\x61\x70\151\x63\x6c\151\x65\156\x74\137\x6b\x65\171\56\x70\145\155"; goto SZKXq; jIGOA: $this->total_fee = $total_fee; goto J5TkU; rRA1B: $this->mch_id = $mch_id; goto Y9K7h; VNNe5: $this->types = $types; goto CbCvv; CbCvv: $this->formid = $formid; goto k7KH0; ysw4r: $this->sslcert_path = __DIR__ . "\x2f\103\145\162\x74\57" . $path . "\x2f\141\x70\x69\x63\154\151\x65\x6e\164\137\x63\145\x72\164\x2e\x70\145\155"; goto c97iI; N2BpO: $this->uniacid = $path; goto VNNe5; SZKXq: tWOVz: goto GFGeH; k7KH0: if (!$path) { goto tWOVz; } goto ysw4r; GFGeH: } public function refund() { $result = $this->wxrefundapi(); return $result; } private function wxrefundapi() { goto YVDOE; cfK35: yNbz8: goto HEDYW; b33zU: file_get_contents($url); goto bSefH; dywbj: $parameters = array("\x61\x70\x70\x69\x64" => $this->appid, "\x6d\143\x68\x5f\x69\144" => $this->mch_id, "\156\157\156\143\145\x5f\163\x74\162" => $this->createNoncestr(), "\157\165\x74\x5f\x72\145\146\165\156\144\x5f\x6e\x6f" => $this->out_refund_no, "\157\x75\x74\137\x74\x72\x61\x64\x65\x5f\x6e\157" => $this->out_trade_no, "\x72\145\x66\x75\x6e\144\137\146\x65\x65" => $this->refund_fee, "\x74\x6f\x74\141\x6c\137\x66\x65\145" => $this->total_fee); goto QAUhw; HBSUR: $result = $this->xmlToArray($xmlresult); goto v6u1m; CwRrJ: if (!($this->types == "\x64\165\x6f" || $this->types == "\x64\165\157\x71\x78" || $this->types == "\144\x61\156" || $this->types == "\x64\x61\156\x71\170")) { goto TJZg0; } goto e9bdX; pjd9Q: file_get_contents($url); goto w1yjr; YVDOE: $url = "\150\164\164\160\163\72\x2f\x2f\141\x70\151\56\155\143\150\x2e\x77\145\x69\x78\151\x6e\56\161\161\56\143\x6f\x6d\57\163\145\143\141\x70\x69\57\x70\x61\171\x2f\x72\x65\x66\165\x6e\x64"; goto dywbj; QAUhw: $parameters["\x73\x69\x67\156"] = $this->getSign($parameters); goto h2uJy; HEDYW: return $result; goto Y4B5T; HZ0ZG: if (!($this->types == "\171\165\171\165\145" || $this->types == "\x79\x75\x79\165\x65\x71\170")) { goto a6res; } goto RZetQ; u4sXc: $xmlresult = $this->postXmlSSLCurl($xmldata, $url, 60); goto HBSUR; v6u1m: if (!($result["\162\x65\164\165\x72\x6e\137\143\x6f\x64\x65"] == "\123\x55\103\103\x45\123\123" && $result["\x72\x65\x73\x75\154\x74\137\x63\x6f\x64\x65"] == "\123\125\x43\x43\x45\123\x53")) { goto yNbz8; } goto CwRrJ; bSefH: a6res: goto cfK35; h2uJy: $xmldata = $this->arrayToXml($parameters); goto u4sXc; e9bdX: $url = $this->getNotifyUrl("\x2f\141\x70\x70\x2f\151\156\144\145\x78\x2e\160\x68\x70\77\151\x3d" . $this->uniacid . "\x26\146\x72\x6f\155\x3d\167\170\x61\160\160\46\143\x3d\x65\x6e\164\x72\x79\46\x61\75\x77\170\x61\x70\x70\46\144\157\x3d\x72\x65\x66\165\x6e\144\x6e\x6f\164\151\x66\171\46\155\75\163\165\144\165\70\x5f\x70\x61\x67\145\x26\x6f\x75\164\x5f\x72\145\146\165\156\144\x5f\x6e\157\75" . $result["\x6f\165\x74\x5f\162\x65\x66\165\156\144\137\x6e\x6f"] . "\x26\x74\x79\160\x65\163\75" . $this->types); goto pjd9Q; RZetQ: $url = $this->getNotifyUrl("\57\x61\160\x70\57\x69\156\144\145\x78\56\x70\x68\160\77\x69\x3d" . $this->uniacid . "\x26\146\x72\x6f\155\x3d\x77\170\141\x70\160\46\143\75\145\x6e\x74\162\171\46\x61\x3d\x77\170\x61\160\160\x26\x64\157\x3d\162\x65\x66\165\x6e\144\x6e\157\x74\x69\x66\171\x26\155\x3d\163\165\x64\165\70\137\x70\141\147\145\46\x6f\x75\x74\x5f\x72\145\146\165\156\x64\137\x6e\x6f\x3d" . $result["\x6f\165\x74\137\x72\145\146\x75\x6e\x64\137\156\x6f"] . "\x26\164\171\x70\x65\163\x3d" . $this->types . "\46\x66\157\162\155\151\x64\x3d" . $this->formid); goto b33zU; w1yjr: TJZg0: goto HZ0ZG; Y4B5T: } private function postXmlSSLCurl($xml, $url, $second = 30) { goto OoPBg; DLGEx: $error = curl_errno($ch); goto FvVZe; ma0Ww: curl_setopt($ch, CURLOPT_SSLCERT, $this->sslcert_path); goto mQElM; oHz0y: curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); goto VvmuP; YlUXZ: curl_setopt($ch, CURLOPT_URL, $url); goto rxJWM; fXbuy: $data = curl_exec($ch); goto okIEO; n1O5n: goto vgPBe; goto ILW18; XqMOn: curl_setopt($ch, CURLOPT_SSLKEY, $this->sslkey_path); goto aiG1R; p3Pok: curl_setopt($ch, CURLOPT_POSTFIELDS, $xml); goto fXbuy; aiG1R: curl_setopt($ch, CURLOPT_POST, true); goto p3Pok; fGO24: return false; goto n1O5n; dIBfQ: vgPBe: goto F010N; okIEO: if ($data) { goto UWB9V; } goto DLGEx; FvVZe: curl_close($ch); goto fGO24; qIzxY: return $data; goto dIBfQ; OoPBg: $ch = curl_init(); goto XV4Ii; VvmuP: curl_setopt($ch, CURLOPT_SSLCERTTYPE, "\x50\105\115"); goto ma0Ww; ILW18: UWB9V: goto PUmym; PUmym: curl_close($ch); goto qIzxY; mQElM: curl_setopt($ch, CURLOPT_SSLKEYTYPE, "\x50\105\115"); goto XqMOn; gRhm6: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE); goto GEw37; XV4Ii: curl_setopt($ch, CURLOPT_TIMEOUT, $second); goto YlUXZ; rxJWM: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); goto gRhm6; GEw37: curl_setopt($ch, CURLOPT_HEADER, FALSE); goto oHz0y; F010N: } }