<?php
 include_once "\145\162\162\x6f\162\103\157\144\x65\56\160\x68\160"; class WXBizDataCrypt { private $appid; private $sessionKey; public function __construct($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto abfF2; MjU30: return ErrorCode::$IllegalIv; goto fpCKf; MsZX8: if (!($dataObj->watermark->appid != $this->appid)) { goto qBwRj; } goto gJkf8; iT2ZZ: $result = openssl_decrypt($aesCipher, "\x41\105\123\x2d\x31\62\70\x2d\103\x42\103", $aesKey, 1, $aesIV); goto S2ufg; fY9xG: bVRRr: goto MsZX8; fpCKf: WqrkV: goto GpNgt; fknUf: return ErrorCode::$IllegalAesKey; goto y3ZwQ; S2ufg: $dataObj = json_decode($result); goto AkblS; hs9il: $data = $result; goto DWk3Y; dbOru: $aesCipher = base64_decode($encryptedData); goto iT2ZZ; DWk3Y: return ErrorCode::$OK; goto p7eDF; gJkf8: return ErrorCode::$IllegalBuffer; goto l81BQ; GpNgt: $aesIV = base64_decode($iv); goto dbOru; abfF2: if (!(strlen($this->sessionKey) != 24)) { goto dey62; } goto fknUf; l81BQ: qBwRj: goto hs9il; OzRhS: return ErrorCode::$IllegalBuffer; goto fY9xG; y3ZwQ: dey62: goto akP91; DzJmP: if (!(strlen($iv) != 24)) { goto WqrkV; } goto MjU30; AkblS: if (!($dataObj == NULL)) { goto bVRRr; } goto OzRhS; akP91: $aesKey = base64_decode($this->sessionKey); goto DzJmP; p7eDF: } }